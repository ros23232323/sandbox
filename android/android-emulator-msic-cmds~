#list connected devices
adb devices

#install apk on connected device
adb -s 192.168.56.101:5555 install ./app/build/outputs/apk/OApp-debug.apk

#adb connect to device
adb connect 192.168.56.101

#adb
adb -s 192.168.56.101:5555 shell monkey -p com.overstock.android.prototype -v 500

#gradle ut it and sonar
gradle clean connectedDebugAndroidTest testDebugUnitTestCoverage sonarqube


#LIST POSSIBLE EMULATORS
android list targets

#list creaTED EMULATORS
android list avd

android create avd -n api_5_0_1__21_LOLLIPOP -t 1 --abi google_apis/x86_64 
android create avd -n api_5_1_1__22_LOLLIPOP -t 2 --abi google_apis/x86_64
android create avd -n api_6_0__23_MARSHMALLOW  -t 7 --abi google_apis/x86_64


emulator -avd $(emulator -list-avds | grep 23) -memory 1024 &

#kill emulator process running on port 5554
and 

kill -9 $(netstat -lpn 2>/dev/null | grep 5554 | awk '{print $7}' | grep -o [0-9]*/ | grep -o [0-9]*)
kill -9 $(netstat -lpn 2>/dev/null | grep 5556 | awk '{print $7}' | grep -o [0-9]*/ | grep -o [0-9]*)
kill -9 $(netstat -lpn 2>/dev/null | grep 5558 | awk '{print $7}' | grep -o [0-9]*/ | grep -o [0-9]*)

android delete avd -n $(emulator -list-avds | grep 21)
android delete avd -n $(emulator -list-avds | grep 22)
android delete avd -n $(emulator -list-avds | grep 23)

echo "no" | android create avd -n api_5_0_2__21_LOLLIPOP -t 1 --abi google_apis/x86_64
echo "no" | android create avd -n api_5_1_1__22_LOLLIPOP -t 2 --abi google_apis/x86_64
echo "no" | android create avd -n api_6_0__23_MARSHMALLOW  -t 7 --abi google_apis/x86_64
android list avd


emulator -avd $(emulator -list-avds | grep 21) -port 5554  &
emulator -avd $(emulator -list-avds | grep 22) -port 5556  &
kill -9 $(netstat -lpn 2>/dev/null | grep 5558 | awk '{print $7}' | grep -o [0-9]*/ | grep -o [0-9]*)
emulator -avd $(emulator -list-avds | grep 23) -port 5558  &

#list devices
adb devices
s
#send shell cmds
adb -s emulator-5554 shell "ls -al /data/app/ApiDemos"

#delete apk from emulator
adb -s emulator-5554 shell "pm uninstall com.overstock.android.prototype"
emulator -avd $(emulator -list-avds | grep 23) -port 5558  &

#install apk on emlator
adb -s emulator-5554  install /home/itowey/dev/git_repos/oapp-prototype/app/build/outputs/apk/OApp-debug-androidTest-unaligned.apk
adb -s emulator-5556  install /home/itowey/dev/git_repos/oapp-prototype/app/build/outputs/apk/OApp-debug-androidTest-unaligned.apk
adb -s emulator-5558  install /home/itowey/dev/git_repos/oapp-prototype/app/build/outputs/apk/OApp-debug-androidTest-unaligned.apk

#logcat specific device
adb -s emulator-5554 logcat *W

adb kill-server
adb start-server

echo "no" | android create avd -n api_6_0__23_MARSHMALLOW  -t 7 --abi google_apis/x86_64
emulator -avd $(emulator -list-avds | grep 23) -port 5558  &
adb -s emulator-5558 logcat > it_run.log &
adb -s emulator-5558 shell "pm uninstall com.overstock.android.prototype"
adb -s emulator-5558  install /home/itowey/dev/git_repos/oapp-prototype/app/build/outputs/apk/OApp-debug.apk
sdk use gradle 2.10 && gradle connectedDebugAndroidTest

adb -s emulator-5558 shell "cat /data/tombstones/tombstone_03"

#run a specific instrumentation test from the commandline (emulator/device required to be running)
./gradlew app:connectedAndroidTest -Pandroid.testInstrumentationRunnerArguments.class=com.example.android.testing.blueprint.ui.espresso.EspressoTest

./gradle app:connectedAndroidTest -Pandroid.testInstrumentationRunnerArguments.class=com.overstock.android.prototype.espresso.fragment.ImageGalleryFragmentTest

#This command will compile the code.
./gradlew assembleDebug

#install the APK on device with serial number 02157df2c2460c0b, -r will means overwrite any provious versions
adb install -r app/build/outputs/apk/app-debug-unaligned.apk -s 02157df2c2460c0b

#run the app
adb shell am start -n com.example.android.sunshine.app/com.example.android.sunshine.app.MainActivityfsdfsdf

\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\run instrumentation tests from cmd line
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
#remove apk and test 
emulator -avd $(emulator -list-avds | grep 23) -port 5558  &
adb -s 1215fcd938411e04 shell "pm uninstall com.overstock.android.prototype"
adb -s 1215fcd938411e04 shell "pm uninstall com.overstock.android.prototype.test"
gradle clean assembleDebug (build apk and test apk)
#load app to device with id 1215fcd938411e04 (found using cmd adb devices) 
adb push /home/itowey/dev/git_repos/oapp-prototype/app/build/outputs/apk/OApp-debug.apk /data/local/tmp/com.overstock.android.prototype
adb shell pm install -r "/data/local/tmp/com.overstock.android.prototype"
#load test app
adb push /home/itowey/dev/git_repos/oapp-prototype/app/build/outputs/apk/OApp-debug-androidTest-unaligned.apk /data/local/tmp/com.overstock.android.prototype.test
adb shell pm install -r "/data/local/tmp/com.overstock.android.prototype.test"
#Running a specific test
adb shell am instrument -w -r   -e debug false -e class com.overstock.android.prototype.espresso.activity.FeedActivityTest com.overstock.android.prototype.test/android.support.test.runner.AndroidJUnitRunner

gradle app:connectedAndroidTest -Pandroid.testInstrumentationRunnerArguments.class=com.overstock.android.prototype.espresso.activity.BrandActivityTest

#Running tests in a package
adb shell am instrument -w -r   -e package com.overstock.android.prototype.espresso.activity -e debug false com.overstock.android.prototype.test/android.support.test.runner.AndroidJUnitRunner

#
sdk use gradle 2.13 && gradle clean assembleDebugAndroidTest uninstallDebug connectedDebugAndroidTest --stacktrace

export releaseVersion=$(echo $(cat $WORKSPACE/app/gradle.properties) | grep -o [0-9]\.[0-9])
if [ ! -z $releaseVersion ]
then
export BUILD_VERSION=$releaseVersion
export newVersion=$(echo "$releaseVersion +0.1" | bc)-SNAPSHOT
./gradlew clean assembleRelease && ./gradlew release -Prelease.releaseVersion=$releaseVersion -Prelease.newVersion=$newVersion
echo "$releaseVersion created"
else
echo "Failure : Version NOT created"
exit 1
fi

export BUILD_NUMBER=21
export STORE_PASSWORD=0app0ver5tok
export KEY_PASSWORD=al1a5pwd!
git checkout master
git checkout .
git pull 
gradle clean assembleRelease && gradle release -Prelease.releaseVersion=$releaseVersion -Prelease.newVersion=$newVersion -DsigningConfig.storePassword=$STORE_PASSWORD -DsigningConfig.keyPassword=$KEY_PASSWORD --stacktrace
gradle clean assembleRelease && gradle release -Prelease.releaseVersion=$releaseVersion -Prelease.newVersion=$newVersion -DsigningConfig.storePassword=$STORE_PASSWORD -DsigningConfig.keyPassword=$KEY_PASSWORD -DBUILD_NUMBER=$releaseBuildNumber -DBUILD_VERSION=$releaseVersion --stacktrace
./gradlew assemble release -Prelease.releaseVersion=$releaseVersion -Prelease.newVersion=$newVersion



sdk use gradle 2.13
gradle clean 
find . -name *.apk
gradle assembleDebug 
gradle assembleDebugAndroidTest 
gradle uninstallDebug 
gradle connectedDebugAndroidTest 




alias gradle_it='sdk use gradle 2.13 && gradle clean assembleDebug assembleDebugAndroidTest uninstallDebug :app:connectedDebugAndroidTest --stacktrace'


sdk use gradle 2.13 && gradle clean assembleDebug
emulator -avd $(emulator -list-avds | grep 23) -port 5558  &
adb -s emulator-5554 shell "pm uninstall com.overstock.android.prototype"

adb install -r app/build/outputs/apk/app-debug-unaligned.apk -s emulator-5558


adb -s emulator-5558 logcat *W
