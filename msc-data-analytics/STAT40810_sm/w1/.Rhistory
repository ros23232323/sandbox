x <- c(38 ,34 ,32 ,34 ,32 ,27 ,28 ,36 ,37 ,33)
x_bar <- mean(x)
x_mean <- mean(x)
x_var <- var(x)
x <- c(38 ,34 ,32 ,34 ,32 ,27 ,28 ,36 ,37 ,33)
xbar <- mean(x)
s2 <- var(x)
phat <- 1 - s2/xbar
nhat <- xbar/phat
phat <- function(x,n){
sum(x)/n*length(x)
}
phat(x,10)
choose(12,2)
choose(12,3)
choose(10,xi)
choose(10,x)
x <- c(38 ,34 ,32 ,34 ,32 ,27 ,28 ,36 ,37 ,33)
choose(10,x)
choose(50,x)
log(choose(50,x))
sum(log(choose(50,x)))
sum(lchoose(50,x))
log_likeihood_bin <- function(x,n,p){
m <- length(x)
ans <- sum(lchoose(n,x))
ans <- ans + sum(x)*log(p) + (n*m -sum(x))*log(1-p)
ans
}
?plot
for(n1 in 1 to 10)
print(n1)
?for
?for
??for
@
seq(1,10,1)
for(n1 in seq(1,10,1))
print(n1)
phat <- function(x,n){
sum(x)/n*length(x)
}
y <- c()
y
y[1] <- 0
y[2] <- 0
y
y[3] <- 3
y
y <- c()
for(n1 in seq(1,100,1)){
p_hat <- phat(x,n1)
y[n1] <- log_likeihood_bin(x,n1,p_hat)
}
warnings()
log_likeihood_bin <- function(x,n,p){
m <- length(x)
ans <- sum(lchoose(n,x))
ans <- ans + sum(x)*log(p) + (n*m -sum(x))*log(1-p)
ans <- ifelse(is.nan(ans),0,ans)
}
y <- c()
for(n1 in seq(1,100,1)){
p_hat <- phat(x,n1)
y[n1] <- log_likeihood_bin(x,n1,p_hat)
}
y
m <- length(x)
m
m <- length(x)
n <- 50
ans <- sum(lchoose(n,x)) + sum(x)*log(p) + (n*m -sum(x))*log(1-p)
m <- length(x)
n <- 50
p <- phat(x,n)
ans <- sum(lchoose(n,x)) + sum(x)*log(p) + (n*m -sum(x))*log(1-p)
sum(lchoose(n,x))
sum(x)*log(p)
n*m
sum(x)
log(1-p)
p
n
sum(lchoose(n,x))
log_likeihood_bin <- function(x,n,p){
sum(dbinom((x, n, p, log = TRUE))) #maximum likelihood estimator
}
log_likeihood_bin <- function(x,n,p){
sum(dbinom(x, n, p, log = TRUE)) #maximum likelihood estimator
}
y <- c()
for(n1 in seq(1,100,1)){
p_hat <- phat(x,n1)
y[n1] <- log_likeihood_bin(x,n1,p_hat)
}
y
x <- c(38 ,34 ,32 ,34 ,32 ,27 ,28 ,36 ,37 ,33)
phat <- function(x,n){
m <- length(x)
sum(x)/n*m
}
phat <- function(x_obs,n){
m <- length(x_obs)
sum(x_obs)/n*m
}
log_likeihood_bin <- function(x_obs,n,p){
sum(dbinom(x_obs, n, p, log = TRUE)) #maximum likelihood estimator
}
y <- c()
for(n1 in seq(1,100,1)){
p_hat <- phat(x,n1)
y[n1] <- log_likeihood_bin(x,n1,p_hat)
}
y
y <- c()
for(n1 in seq(1,100,1)){
y[n1] <- log_likeihood_bin(x,n1,phat(x,n1))
}
y
y <- c()
for(n1 in seq(1,100,1)){
print(log_likeihood_bin(x,n1,phat(x,n1)))
}
x <- c(38 ,34 ,32 ,34 ,32 ,27 ,28 ,36 ,37 ,33)
phat <- function(x_obs,n){
m <- length(x_obs)
sum(x_obs)/n*m
}
log_likeihood_bin <- function(x_obs,n,p){
sum(dbinom(x_obs, n, p, log = TRUE)) #maximum likelihood estimator
}
y <- c()
for(n1 in seq(1,100,1)){
print(log_likeihood_bin(x,n1,phat(x,n1)))
}
y <- c()
for(n1 in seq(1,100,1)){
y[n1] <- log_likeihood_bin(x,n1,phat(x,n1))
}
l<-function(n,p,x)
{
sum(dbinom(x,n,p,log=TRUE))
}
phat<-function(x,n)
{
m<-length(x)
sum(x)/(n*m)
}
l2<-function(n,x)
{
l(n,phat(x,n),x)
}
nvec<-1:100
lvec<-rep(NA,length(nvec))
for (n in nvec)
{
lvec[n]<-l2(nvec[n],x)
}
plot(nvec,lvec,pch=3,xlab="n",ylab="Log-likelihood (l)")
abline(v=49,col="gray",lty=3)
text(10,-27,"(n,p)=(49,0.68)",col="blue")
nvec
lvec
phat(x,49)
max(lvec)
max(lvec[!is.nan(lvec)])
x <- c(38 ,34 ,32 ,34 ,32 ,27 ,28 ,36 ,37 ,33)
xbar <- mean(x)
s2 <- var(x)
phat <- 1 - s2/xbar
nhat <- xbar/phat
phat
nhat
phat <- function(x_obs,n){
m <- length(x_obs)
sum(x_obs)/n*m
}
log_likeihood_bin <- function(x_obs,n,p){
sum(dbinom(x_obs, n, p, log = TRUE)) #maximum likelihood estimator
}
y <- c()
for(n1 in seq(1,100,1)){
y[n1] <- log_likeihood_bin(x,n1,phat(x,n1))
}
y
x_obs
n
p
phat1 <- function(x_obs,n){
m <- length(x_obs)
sum(x_obs)/n*m
}
phat1(x,49)
phat<-function(x,n)
{
m<-length(x)
sum(x)/(n*m)
}
phat(x,49)
phat1(x,49)
phat1 <- function(x_obs,n){
m <- length(x_obs)
sum(x_obs)/(n*m)
}
phat1(x,49)
phat(x,49)
log_likeihood_bin <- function(x_obs,n,p){
sum(dbinom(x_obs, n, p, log = TRUE)) #maximum likelihood estimator
}
y <- c()
for(n1 in seq(1,100,1)){
y[n1] <- log_likeihood_bin(x,n1,phat1(x,n1))
}
y
y <- c()
for(n_i in seq(1,100,1)){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x_i))
}
y
y <- c()
for(n_i in seq(1,100,1)){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
y
y <- c()
n_vals <- seq(1,100,1)
for(n_i in n_vals){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
abline(v=49,col="gray",lty=3)
text(10,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
text(10,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
text(20,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
abline(v=49,col="gray",lty=3)
text(20,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
max(lvec[!is.nan(lvec)])
index(max(lvec[!is.nan(lvec)]))
which.is.max(lvec[!is.nan(lvec)])
which(y==max(y[!is.nan(y)]))
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=3)
text(20,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
y <- c()
n_vals <- seq(1,1000,1)
for(n_i in n_vals){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
y
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=3)
text(20,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=3)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=2)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=2,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=1,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=.5,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=.2,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=2,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
?plot
y
y <- c()
n_vals <- seq(1,100,1)
for(n_i in n_vals){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
y
?plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
y <- c()
n_vals <- seq(1,100,1)
for(n_i in n_vals){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
y
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
y <- c()
n_vals <- seq(1,1500,1)
for(n_i in n_vals){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
y
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
xbar <- mean(x)
s2 <- var(x)
phat <- 1 - s2/xbar
nhat <- xbar/phat
phat*nhat
phat1 <- function(x_obs,n){
m <- length(x_obs)
sum(x_obs)/(n*m)
}
y <- c()
n_vals <- seq(1,100,1)
for(n_i in n_vals){
y[n_i] <- log_likeihood_bin(x,n_i,phat1(x,n_i))
}
y
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(300,-27,"function maximized at (n,p)=(49,0.68)",col="blue")
plot(n_vals,y,pch=3,xlab="n",ylab="Log-likelihood (l)")
idx_of_max <- which(y==max(y[!is.nan(y)]))
abline(v=idx_of_max,col="gray",lty=1)
text(60,-29,"function maximized at (n,p)=(49,0.68)",col="blue")
rm(list=ls())
x <- scan()
x <- scan()
x
rm(list=ls())
x <- scan()
rm(list=ls())
x <- scan()
x
max(x)
min(x)
mean(x)
var(x)
plot(x)
